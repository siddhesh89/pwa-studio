<!DOCTYPE html>
<html lang="" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>State management | Magento PWA Documentation</title>
	<meta name="description" content="Everything you need to build a Magento PWA.">

	<link rel="stylesheet" href="/pwa-studio/assets/css/app.css?ver=7" />
	<link rel="stylesheet" href="/pwa-studio/assets/css/print.css?ver=7" media="print"/>

	<link rel="stylesheet" href="/pwa-studio/builds/css/main.css" />

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

	<script>
  var baseUrl = "/pwa-studio";
  var algolia = {
    id : "E642SEDTHL",
    index: "pwa-devdocs",
    key: "d2d0f33ab73e291ef8d88d8b565e754c"
  };

  var indices = [
    {
      label: "PWA",
      name: "pwa-devdocs",
      baseUrl: "https://pwastudio.io"
    },
    {
      label: "DevDocs",
      name: "devdocs",
      facets: [["guide_version: 2.3", "versionless: true"]],
      refinements: [
        {
          label: "Functional areas",
          attribute: "functional_areas"
        }
      ],
      baseUrl: "https://devdocs.magento.com"
    },
    {
      label: "User Guide",
      name: "merchdocs_ee",
      baseUrl: "https://docs.magento.com/m2/ee/user_guide"
    },
    {
      label: "MBI User Guide",
      name: "merchdocs-mbi",
      baseUrl: "https://docs.magento.com/mbi"
    },
    {
      label: "Order Management",
      name: "oms-en",
      baseUrl: "https://omsdocs.magento.com"
    }
  ];
</script>



<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KRCLXBB');</script>
<!-- End Google Tag Manager -->




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">


	<header class="site-header">
		<nav class="site-nav">

  <div class="nav-container">

    <div class="menu-btn">
      <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
    </div>

    <a class="logo" data-proofer-ignore href="/pwa-studio/">
      <img src="/pwa-studio/assets/i/m-logo.svg" alt="">
      <img src="/pwa-studio/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">PWA Docs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      

      <!-- Main Navigation -->
<ul class="nav-main" role="menubar">

  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span href="#" data-proofer-ignore tabindex="-1">Getting Started</span>
    <div class="nav-popup">
      <ul>
        
        <li role="menuitem">
          <a href="/pwa-studio/technologies/overview/">Overview</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/technologies/storefront-architecture/">Storefront architecture</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/technologies/basic-concepts/">Basic concepts</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/pwa-buildpack/">PWA Buildpack</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/peregrine/">Peregrine</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/venia-pwa-concept/">Venia storefront concept</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/technologies/upward/">UPWARD</a>
        </li> 
        
      </ul>
    </div>
  </li>

  

  
  <li class="menuitem ">
      <a href="/pwa-studio/tutorials/">Tutorials</a>
  </li>
  

  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span href="#" data-proofer-ignore tabindex="-1">Reference API</span>
    <div class="nav-popup">
      <ul>
        
        <li role="menuitem">
          <a href="/pwa-studio/pwa-buildpack/reference/buildpack-cli/">PWA Buildpack</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/peregrine/reference/item/">Peregrine API</a>
        </li> 
        
        <li role="menuitem">
          <a href="/pwa-studio/venia-ui/reference/components/Button/">Venia UI API</a>
        </li> 
        
      </ul>
    </div>
  </li>

  

  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span href="#" data-proofer-ignore tabindex="-1">Integrations</span>
    <div class="nav-popup">
      <ul>
        
        <li role="menuitem">
          <a href="/pwa-studio/pagebuilder/">Page Builder</a>
        </li> 
        
      </ul>
    </div>
  </li>

  

</ul>

    </div>

    <div class="nav-actions">
        
<div class="app-switcher">
  <div class="dropdown">
    <button id="app-switcher-trigger" class="app-switcher-trigger" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="Documentation sites"></button>
    <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="app-switcher-trigger" role="menu">
      <div class="app-switcher-content">
      
      <div class="app-switcher-group">
        <h3 class="app-swither-group-title">Developer</h3>
        
        <li role="menuitem"><a class="dropdown-item" href="https://devdocs.magento.com/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce Developer Documentation">Commerce Developer Documentation</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="http://pwastudio.io/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=PWA Studio">PWA Studio</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://omsdocs.magento.com/en/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
      </div>
      
      <div class="app-switcher-group">
        <h3 class="app-swither-group-title">Merchant</h3>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/m2/ee/user_guide/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce User Guide">Commerce User Guide</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://omsdocs.magento.com/en/userguides/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/mbi/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Business Intelligence">Business Intelligence</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/marketplace/user_guide/getting-started.html?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Marketplace">Marketplace</a></li>
        
      </div>
      
      </div>
    </ul>
  </div>
</div>


        <div class="search-btn">
          <button class="search-trigger search-icon" aria-label="Search"></button>
        </div>
    
        <form class="quick-search" action="/pwa-studio/search/" method="get" novalidate="novalidate">
          <input type="search" name="query" placeholder="Search" />
          <button class="quick-search-close" aria-label="Close search">&times;</button>
        </form>

    </div>

  </div>
</nav><!-- .site-nav -->
<div class="nav-main-fader"></div>

	</header>

	<div class="global-wrapper">
		<div class="message-banner">
If you have any project questions, concerns, or contribution ideas, join our <a href="https://magentocommeng.slack.com/messages/C71HNKYS2"><strong>#pwa</strong></a> Slack channel.
Find out how to create an account by visiting <a href="https://devdocs.magento.com/community/resources/resources.html">Community Resources</a>
</div>


		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
    <button class="toc-toggler">Table of Contents</button>
    <div class="sidebar-wrapper">

      






<div class="menu-section">
    <div class="toc-entry"><h4 class="guide-title">Getting Started</h4></div>

    <ul class="table-of-contents">
    
        <li >
            
            <a href="/pwa-studio/technologies/overview/" class=" ">Overview</a>
            

            
        </li>
    
        <li >
            
            <a href="/pwa-studio/technologies/tools-libraries/" class=" ">Tools and libraries</a>
            

            
        </li>
    
        <li >
            
            <span>Magento integration</span>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/magento-compatibility/" class=" ">Magento compatibility</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/theme-vs-storefront/" class=" ">Magento theme vs PWA storefront</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/technologies/storefront-architecture/" class=" parent">PWA Storefront architecture</a>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/storefront-architecture/runtime/" class=" ">Runtime architecture</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/storefront-architecture/buildtime/" class=" ">Build-time architecture</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/technologies/basic-concepts/" class=" parent">Basic concepts</a>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/basic-concepts/app-shell/" class=" ">Application shell</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/basic-concepts/content-rendering/" class=" ">Content rendering</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/basic-concepts/css-modules/" class=" ">CSS modules</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/basic-concepts/graphql/" class=" ">GraphQL</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/basic-concepts/client-side-caching/" class=" ">Client-side caching</a>
                    
                </li>
            
                <li class="active">
                    
                    <a href="/pwa-studio/technologies/basic-concepts/state-management/" class=" ">State management</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/pwa-buildpack/" class=" parent">PWA Buildpack</a>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/pwa-buildpack/configuration-management/" class=" ">Configuration management</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/pwa-buildpack/scaffolding/" class=" ">Scaffolding</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/pwa-buildpack/scaffolding/custom-project-templates/" class=" ">Custom project templates</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/pwa-buildpack/troubleshooting/" class=" ">Troubleshooting</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/peregrine/" class=" parent">Peregrine</a>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/peregrine/talons/" class=" ">Talons</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/peregrine/routing/" class=" ">Routing in PWA Studio</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/venia-pwa-concept/" class=" parent">Venia storefront concept</a>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/venia-pwa-concept/setup/" class=" ">Storefront setup</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/venia-pwa-concept/install-sample-data/" class=" ">Install Venia sample data</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/venia-pwa-concept/project-structure/" class=" ">Project structure</a>
                    
                </li>
            
                <li >
                    
                    <a href="/pwa-studio/venia-pwa-concept/features/modular-components/" class=" ">Modular components</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/technologies/upward/" class=" parent">UPWARD</a>
            

            
            <ul>
            
                <li >
                    
                    <a href="/pwa-studio/technologies/upward/reference-implementation/" class=" ">Reference implementation</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li >
            
            <a href="/pwa-studio/technologies/versioning/" class=" ">Versioning strategy</a>
            

            
        </li>
    
        <li >
            
            <a href="/pwa-studio/technologies/contribute/" class=" ">Contributing to PWA Studio</a>
            

            
        </li>
    
    </ul>
</div>



    </div>
</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	<h1 class="page-heading">State management</h1>
</section>

			<h2 id="what-is-state-management">What is state management</h2>

<p>An application, such as a PWA storefront, uses state data to render dynamic content to the user.
State management describes the way the application handles changing state data as a result of user interactions.</p>

<p>Interactions, such as clicking on a button or loading the page, modify the state and update the appearance or behavior of the application.</p>

<p>For example, a shopper clicks on a button to add an item to the shopping cart.
The application needs a way to add that item to the shopping cart while the shopper continues to browse the application.
It also needs to update the visual components that use shopping cart data to reflect the new state.</p>

<h2 id="local-versus-global-state">Local versus global state</h2>

<p>Local and global are the two different types of state a component can depend on.</p>

<p>Local state data is any data scoped within a component or its children components.
This type of data is not shared with a component’s parent or peer data.
Otherwise, that data should be <a href="https://reactjs.org/docs/lifting-state-up.html">lifted</a>.</p>

<p>For example, a button component’s disabled state is never used outside that component, so
it is categorized as local state data.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">MyButton</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">isDisabled</span><span class="p">,</span> <span class="nx">setIsDisabled</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">handleClick</span><span class="o">=</span> <span class="nx">useCallback</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">setIsDisabled</span><span class="p">(</span><span class="kc">true</span><span class="p">),[])</span>

    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick=</span><span class="si">{</span><span class="nx">handleClick</span><span class="si">}</span> <span class="na">disabled=</span><span class="si">{</span><span class="nx">isDisabled</span><span class="si">}</span><span class="p">&gt;</span>Click me!<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Global state data is any data made available to components in the entire application.
Components that depend on a global state value subscribe to changes for that value and re-render themselves.
Most components do not depend on the entire global state.
Instead, a component only uses small pieces of the entire global state.</p>

<p>Shopping cart data is an example of global state data that components in different levels of the application use and modify.</p>

<h2 id="common-state-management-technologies">Common state management technologies</h2>

<p>There are many libraries and framework features that implement state management.
This section describes two such technologies used in the PWA Studio project.</p>

<h3 id="redux">Redux</h3>

<p><a href="https://redux.js.org/introduction/getting-started">Redux</a> is a state management design pattern and library.
It promotes the idea of a global object tree that contains the state of the whole application.
This object is known as a <a href="https://redux.js.org/glossary#store">store</a>.</p>

<p>The store is a read-only object, which can only be updated by dispatching a <a href="https://redux.js.org/glossary#reducer">reducer</a> function.
Reducer functions accept the current state and an <a href="https://redux.js.org/basics/actions">action</a> object as parameters and returns the next state.</p>

<p>Application components are able to <a href="https://redux.js.org/api/store#dispatchaction">dispatch</a> various actions to update the state.
Components can also <a href="https://redux.js.org/api/store#subscribelistener">subscribe</a> to state changes to update their appearance or behavior.</p>

<p>Early versions of PWA Studio used the Redux library directly as the primary mechanism for managing application state,
and the Redux pattern can be seen in hooks such as <a href="https://github.com/magento/pwa-studio/blob/develop/packages/peregrine/lib/hooks/useRestResponse.js"><code class="highlighter-rouge">useRestResponse()</code></a>.</p>

<p>Currently, PWA Studio abstracts away its Redux implementation details using Peregrine hooks and context providers.
This opens up the possibility of the project replacing Redux in Peregrine with another state management library without breaking state dependent components, such as those in Venia.</p>

<p>PWA Studio allows you to customize reducers and enhancers.
The following example uses <code class="highlighter-rouge">combineReducers()</code> to combine the default Peregrine reducers with custom reducers specific to the project and uses the combined reducers when creating the Redux store.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Example src/store.js file</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">combineReducers</span><span class="p">,</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">enhancer</span><span class="p">,</span> <span class="nx">reducers</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@magento/peregrine</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">myReducers</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./lib/reducers</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// You can add your own reducers here and combine them with the Peregrine exports.</span>
<span class="kd">const</span> <span class="nx">rootReducer</span> <span class="o">=</span> <span class="nx">combineReducers</span><span class="p">({</span> <span class="p">...</span><span class="nx">reducers</span><span class="p">,</span> <span class="p">...</span><span class="nx">myReducers</span> <span class="p">});</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">rootReducer</span><span class="p">,</span> <span class="nx">enhancer</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="react-hooks">React hooks</h3>

<p>React version 16.8 introduced the concept of <a href="https://reactjs.org/docs/hooks-intro.html">hooks</a>.
Hooks allow <a href="https://reactjs.org/docs/components-and-props.html#function-and-class-components">function components</a> to manage their own internal state by letting them use the same component lifecycle features available to class components.</p>

<p>Earlier versions of React only allowed class components to manage state,
so stateful classes often became complex and hard to understand.
Hooks help developers to decompose large components into smaller functions that are focused on specific logic, such as fetching data.</p>

<p>Since PWA Studio favors using function components over classes, it uses many of React’s <a href="https://reactjs.org/docs/hooks-reference.html">built-in hooks</a> in its Venia and Peregrine libraries.
The Peregrine library also provides <a href="https://reactjs.org/docs/hooks-custom.html">custom React hooks</a> for storefront developers.
These hooks contain common Magento storefront logic such as state management.</p>

<h2 id="state-management-in-pwa-studio">State management in PWA Studio</h2>

<p>State management in PWA Studio is a mix of the Redux library, React hooks, and React context providers.
The Redux library is the underlying technology that powers state management behind the scenes, but
components do not interact with the global store directly.
Instead, components that need global state data use React hooks and context providers to read or update the current state.</p>

<h3 id="context-providers">Context providers</h3>

<p>React components look and behave as a result of their props.
Normally, this means an application needs to explicitly pass state data as a prop down the React application tree to components that need that data.
This is known as <em>prop drilling</em>.</p>

<p>To avoid prop drilling, React provides the <a href="https://reactjs.org/docs/context.html">Context</a> feature.
The Context feature allows an application to define a value and make it available to its descendants without passing it down the tree.</p>

<p>A Context object contains a Provider and Consumer property.
A <code class="highlighter-rouge">Context.Provider</code> component defines the shared data for its children, and
a corresponding <code class="highlighter-rouge">Context.Consumer</code> acquires the data and subscribes to any changes.</p>

<p>PWA Studio uses the Context feature to provide application state data to storefront components through the <a href="https://github.com/magento/pwa-studio/blob/develop/packages/peregrine/lib/PeregrineContextProvider/peregrineContextProvider.js"><code class="highlighter-rouge">PeregrineContextProvider</code></a> component.
Wrapping an application with the <code class="highlighter-rouge">PeregrineContextProvider</code> lets its components access different slices of the entire application state.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Example src/index.js</span>

<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Adapter</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@magento/venia-drivers</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">PeregrineContextProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@magento/peregrine</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">store</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./store</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// This was defined in the previous example</span>
<span class="k">import</span> <span class="nx">MyApplication</span> <span class="k">from</span> <span class="s2">`./src/components/MyApplication`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">apiBase</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="dl">'</span><span class="s1">/graphql</span><span class="dl">'</span><span class="p">,</span> <span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Adapter</span>
        <span class="na">apiBase=</span><span class="si">{</span><span class="nx">apiBase</span><span class="si">}</span>
        <span class="na">apollo=</span><span class="si">{</span><span class="p">{</span> <span class="na">link</span><span class="p">:</span> <span class="nx">authLink</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">Adapter</span><span class="p">.</span><span class="nx">apolloLink</span><span class="p">(</span><span class="nx">apiBase</span><span class="p">))</span> <span class="p">}</span><span class="si">}</span>
        <span class="na">store=</span><span class="si">{</span><span class="nx">store</span><span class="si">}</span>
    <span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">PeregrineContextProvider</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">MyApplication</span> <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nc">PeregrineContextProvider</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">Adapter</span><span class="p">&gt;,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>

</code></pre></div></div>

<h3 id="global-state-slices">Global state slices</h3>

<p>Peregrine exposes global state data in slices through the <code class="highlighter-rouge">PeregrineContextProvider</code> component and custom React hooks.
A state data slice is a subset of values from the global state.
Each slice contains data about a specific part of the application, such as the shopping cart state or user session state.</p>

<p>To access a global state slice, wrap the <code class="highlighter-rouge">PeregrineContextProvider</code> around the main application (as shown in the previous example).</p>

<p>Next, import the appropriate <a href="https://github.com/magento/pwa-studio/tree/develop/packages/peregrine/lib/context">context hook</a> and decompose the array returned by the hook function call.
The decomposed array yields the state data and an API object to update that state.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Example src/components/MyWelcomeMessage/myWelcomeMessage.js</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">useUserContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@magento/peregrine/lib/context/user</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">MyWelcomeMessage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">userContext</span><span class="p">,</span> <span class="nx">userContextApi</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useUserContext</span><span class="p">();</span>

    <span class="kd">const</span> <span class="p">{</span><span class="nx">isSignedIn</span><span class="p">,</span> <span class="nx">currentUser</span><span class="p">}</span> <span class="o">=</span> <span class="nx">userContext</span><span class="p">;</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">firstname</span><span class="p">,</span> <span class="nx">lastname</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">currentUser</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">isSignedIn</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Welcome <span class="si">{</span><span class="nx">firstname</span><span class="si">}</span> <span class="si">{</span><span class="nx">lastname</span><span class="si">}</span>!<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">MyWelcomeMessage</span><span class="p">;</span>
</code></pre></div></div>

<!-- TODO: Update these links to point to master when they are available in master -->


			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  

  
  <div class="github-link">
    <a class="improve-page" href="https://github.com/magento/pwa-studio/tree/develop/pwa-devdocs/src/technologies/basic-concepts/state-management/index.md" target="_blank">
      Edit this page on GitHub
    </a>
  </div>
  

  
  <div class="new-issue">
    <a href="https://github.com/magento/pwa-studio/issues/new?title=Feedback on page: /technologies/basic-concepts/state-management/" target="_blank">
      Give us feedback
    </a>
  </div>
  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
    <li><a href="http://magento.com/legal/terms/privacy/">Privacy Policy</a></li>
    <li><a href="http://magento.com/legal/terms/">Terms of Service</a></li>
    <li><a href="http://magento.com/legal/licensing/">License/Trademark FAQ</a></li>
    <li><a href="https://magentocommeng.slack.com/messages/C71HNKYS2">#pwa Slack channel</a></li>
  </ul>
    </div>

		<div class="copyright-date">&copy; 2020 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/pwa-studio/assets/js/app.min.js?ver=7"></script>

<script src="/pwa-studio/builds/js/index.bundle.js"></script>

</body>
</html>

